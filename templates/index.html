{% extends "base.html" %}
{% block content %}

<main class="max-w-4xl mx-auto px-4 py-12">
    <div class="mb-10 p-4 bg-white border border-dashed border-gray-300 rounded-lg text-center text-gray-400 italic text-[10px] uppercase tracking-widest">
        –†–µ–∫–ª–∞–º–Ω—ã–π –±–ª–æ–∫
    </div>

    <section class="bg-white rounded-[40px] shadow-xl p-8 md:p-12 border border-gray-50">
        <textarea id="text" class="w-full h-64 p-6 bg-gray-50 border border-gray-100 rounded-[30px] outline-none focus:ring-4 focus:ring-blue-100 text-lg resize-none transition-all font-medium" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –æ–∑–≤—É—á–∫–∏ (–¥–æ 2000 –∑–Ω–∞–∫–æ–≤)..."></textarea>
        
        <div class="mt-8 flex flex-col md:flex-row gap-6 items-end justify-between">
            <div class="w-full md:w-1/2">
                <label class="text-[10px] font-black text-gray-400 uppercase mb-3 block tracking-[0.2em] ml-2">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–ª–æ—Å –∏ —è–∑—ã–∫</label>
                <select id="voiceSelect" class="w-full p-4 bg-white border border-gray-200 rounded-2xl outline-none shadow-sm font-bold text-gray-700 cursor-pointer focus:border-blue-500 transition-all">
                    <optgroup label="–°–ù–ì / CIS">
                        <option value="ru-RU-DmitryNeural">–†—É—Å—Å–∫–∏–π ‚Äî –î–º–∏—Ç—Ä–∏–π (–ú—É–∂—Å–∫–æ–π)</option>
                        <option value="ru-RU-SvetlanaNeural">–†—É—Å—Å–∫–∏–π ‚Äî –°–≤–µ—Ç–ª–∞–Ω–∞ (–ñ–µ–Ω—Å–∫–∏–π)</option>
                        <option value="uk-UA-OstapNeural">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ ‚Äî –û—Å—Ç–∞–ø</option>
                        <option value="kk-KZ-DauletNeural">“ö–∞–∑–∞“õ—à–∞ ‚Äî –î–∞—É–ª–µ—Ç</option>
                    </optgroup>
                    <optgroup label="English">
                        <option value="en-US-AvaNeural">English (US) ‚Äî Ava</option>
                        <option value="en-US-GuyNeural">English (US) ‚Äî Guy</option>
                        <option value="en-GB-SoniaNeural">English (UK) ‚Äî Sonia</option>
                    </optgroup>
                    <optgroup label="Europe & Asia">
                        <option value="de-DE-KatjaNeural">Deutsch (Germany)</option>
                        <option value="fr-FR-DeniseNeural">Fran√ßais (France)</option>
                        <option value="zh-CN-YunxiNeural">Chinese</option>
                        <option value="ja-JP-NanamiNeural">Japanese</option>
                    </optgroup>
                </select>
            </div>
            <button onclick="generateAudio()" id="mainBtn" class="w-full md:w-auto px-16 py-5 bg-blue-600 text-white font-black rounded-[20px] hover:bg-blue-700 shadow-xl shadow-blue-200 transition-all active:scale-95 uppercase tracking-widest text-xs">
                –û–∑–≤—É—á–∏—Ç—å —Å–µ–π—á–∞—Å
            </button>
        </div>

        <div id="result" class="mt-12 pt-12 border-t border-gray-100 hidden text-center">
            <audio id="player" controls class="w-full mb-8 rounded-xl"></audio>
            <div class="flex flex-wrap justify-center gap-4">
                <a id="download" href="#" download class="px-12 py-5 bg-green-500 text-white rounded-[20px] font-black hover:bg-green-600 transition-all shadow-lg shadow-green-100 uppercase tracking-widest text-[10px]">
                    –°–∫–∞—á–∞—Ç—å MP3
                </a>
            </div>
        </div>
    </section>

    <section class="mt-16 p-10 bg-white rounded-[40px] border border-gray-100 text-center shadow-sm">
        <h3 class="text-2xl font-black mb-2 uppercase tracking-tighter">–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç ‚òï</h3>
        <p class="text-gray-500 mb-10 text-sm font-medium">–í–∞—à–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–º –æ–ø–ª–∞—á–∏–≤–∞—Ç—å GPU-—Å–µ—Ä–≤–µ—Ä—ã.</p>
        <div class="flex flex-wrap justify-center gap-4">
            <a href="https://www.buymeacoffee.com/speechclone" target="_blank" class="px-8 py-4 bg-[#FFDD00] text-black font-black rounded-2xl hover:scale-105 transition-all text-[10px] uppercase tracking-widest shadow-md">‚òï Buy me a coffee</a>
            <a href="https://paypal.me/velial39@gmail.com" target="_blank" class="px-8 py-4 bg-[#0070ba] text-white font-black rounded-2xl hover:scale-105 transition-all text-[10px] uppercase tracking-widest shadow-md">PayPal</a>
        </div>
    </section>

    <section class="mt-24 mb-12">
        <div class="text-center mb-16">
            <h3 class="text-4xl font-black text-gray-900 uppercase tracking-tighter">FAQ</h3>
            <div class="h-1.5 w-20 bg-blue-600 mx-auto mt-4 rounded-full"></div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-white p-8 rounded-[35px] border border-gray-50 shadow-sm">
                <h4 class="text-lg font-black text-blue-600 mb-4 uppercase text-xs tracking-widest">üôå –ë–µ—Å–ø–ª–∞—Ç–Ω–æ?</h4>
                <p class="text-gray-600 leading-relaxed text-sm font-medium">–î–∞, –ø—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —ç–Ω—Ç—É–∑–∏–∞–∑–º–µ –∏ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>
            </div>
            <div class="bg-white p-8 rounded-[35px] border border-gray-50 shadow-sm">
                <h4 class="text-lg font-black text-blue-600 mb-4 uppercase text-xs tracking-widest">üé¨ YouTube?</h4>
                <p class="text-gray-600 leading-relaxed text-sm font-medium">–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–∑–≤—É—á–∫—É –≤ –ª—é–±—ã—Ö –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö —Ü–µ–ª—è—Ö.</p>
            </div>
        </div>
    </section>
</main>

<script>
async function generateAudio() {
    const btn = document.getElementById('mainBtn');
    const textInput = document.getElementById('text');
    const voiceSelect = document.getElementById('voiceSelect');
    
    if(!textInput.value.trim()) return alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç");

    btn.disabled = true;
    btn.innerHTML = `<span class="animate-pulse tracking-widest">–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º...</span>`;

    try {
        const response = await fetch('/api/generate', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify({
                text: textInput.value,
                voice: voiceSelect.value
            })
        });

        if (!response.ok) {
            const errorText = await response.text();
            throw new Error(errorText || "–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞");
        }

        const data = await response.json();
        
        if(data.audio_url) {
            const player = document.getElementById('player');
            const resultDiv = document.getElementById('result');
            const downloadLink = document.getElementById('download');
            
            player.src = data.audio_url;
            downloadLink.href = data.audio_url;
            resultDiv.classList.remove('hidden');
            player.play();
        } else {
            alert("–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–∞–π–ª");
        }
    } catch (e) {
        console.error("–û—à–∏–±–∫–∞ API:", e);
        alert("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.");
    } finally {
        btn.disabled = false;
        btn.innerText = "–û–∑–≤—É—á–∏—Ç—å —Å–µ–π—á–∞—Å";
    }
}
</script>

{% endblock %}



